# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Фамилия и имя студента`

### Задание 1

Использование активного master-сервера с пассивным slave-сервером обеспечивает высокую доступность. В такой схеме master обрабатывает все операции записи и чтения, а slave непрерывно реплицирует данные с master. Основное преимущество — это отказоустойчивость: при падении master-сервера slave может быстро занять его место, минимизируя простой системы.

Применение master-сервера с несколькими slave-серверами добавляет к отказоустойчивости горизонтальное масштабирование нагрузки на чтение. Master, как и прежде, отвечает за запись данных, но все запросы на чтение распределяются между несколькими slave-серверами. Это значительно повышает общую производительность и пропускную способность приложения для пользователей, так как чтение — часто наиболее частая операция. Кроме того, такая архитектура повышает надёжность хранения данных и гибкость, позволяя, например, выделять отдельных slave для фоновой аналитики без воздействия на основную работу системы.

---

### Задание 2

`План для выполнения горизонтального и вертикального шаринга базы данных`

<img width="798" height="538" alt="Снимок экрана 2026-02-10 в 16 33 04" src="https://github.com/user-attachments/assets/e443af75-68ba-4df6-8af7-5a490ae5246c" />

**Шард-контроллер** - анализирует тип запроса и ключ данных (например, user_id или тип таблицы) для определения целевого физического шарда.

*Вертикальный шардинг:*

**Шард A1** - для работы с данными пользователей;

**Шард B1** - для работы с каталогом книг;

**Шард C1** -  для работы с данными магазинов.

*Горизонтальный шардинг заложен внутри каждого из указанных блоков*

**Шард A1** (пользователи)

A1.1 - часть таблицы users (записи с user_id от 1 до 500 000).

A1.2 - другая часть таблицы users (записи с user_id от 500 001 до 1 000 000).

**Шард B1** (книги)

Шард B1.1 - книги жанров 1-5.

Шард B1.2 - книги жанров 6-10.

**Шард C1** (магазины)

Шард C1.1 - данные магазинов, относящихся к филиалам 1-3.

Шард C1.2 - данные магазинов, относящихся к филиалам 4-7.

**Режимы работы контейнеров**

Шард-контроллер - active master-router

Физические шарды данных (A1.1, A1.2, B1.1, B1.2, C1.1, C1.2) - active master

---

### Задание 3*

Для настройки выбраны следующие методы методов шардинга из Задания 2

*Вертикальный шардинг* (реализован полностью):

**Контейнер shard1_users + shard2_users** - данные пользователей (реализация блока A1).

**Контейнер shard_books** - каталог книг (реализация блока B1), в виде одного шарда.

**Контейнер shard_stores** - данные магазинов и филиалов (реализация блока C1), в виде одного шарда.

*Горизонтальный шардинг* (реализован частично):

**Только для пользователей**: полностью реализован через два контейнера (shard1_users, shard2_users) с разделением по user_id (1-500000 и 500001-1000000). Это A1.1 и A1.2.

**Для книг и магазинов**: не реализовывался. Каждая сущность находится в едином контейнере.

Каждый контейнер работает как автономный мастер-сервер (active master)

[Конфигурационный файл Docker](docker-compose.yml)

[Конфигурационный файл Docker] (sql_script.sh)
